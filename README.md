# Neo4j Custom metrics reporter/ingester
Neo4j provides metrics reporter for continuous analysis through metrics.

Custom metrics reporter provides custom format for metrics ingestion in statsd.
Neo4j provides metrics as key:value:timestamp format which may not be compatible to statsd so custom metrics reporter provides config based format.
### Instructions
This project uses maven, For building jar file with all dependency, run maven assembly command.

  ```mvn assembly:assembly ```

This will generate jar file with all dependency( target/metrics-ingester-1.0-SNAPSHOT-jar-with-dependencies.jar)

### Config
``` 
metrics.template= [â€œkey","value","timestamp"]  // metrics format generated by neo4j (default -["key","value","timestamp"] )
metrics.delimiter=                             // delimiter in for key value and timestamp
metrics.counter=[vm.memory.buffer.mapped.count,vm.thread.count]    // metrics keys which should be reported as counters.
metrics.timer= [neo4j.bolt.accumulated_queue_time,neo4j.bolt.accumulated_time] // metrics keys which should be reported as timers.
metrics.gauge=[ALL]                              // metrics keys which should be reported as gauge (ALL -> All metrics will be ingested as gauge, all config are overwritten)
statsd.host=stats.host.com                       // statsd host name where metrics should be ingested
statsd.port=8125                                // statsd port
metrics.exclude=[vm.gc.time.g1_old_generation]   // excluded metrics keys which should not be published in statsd
Note : if ALL is given as metric key in any type of metrics then All metrics will be ingested as given metric type.
 ```
 ### Metrics Ingestion 
- Run jar file 
   ```nohup java -jar metrics-ingester-1.0-SNAPSHOT-jar-with-dependencies.jar localhost port_number file_path_of_config.properties  & ```

 - Edit your neo4j/conf/neo4j.conf file by editing/adding this line
 ```metrics.graphite.server=ip:port```
    - ip - host/ip of machine where metrics reporter is running.
    - port - port on which metrics reporter is listening. (port_number on which above command executed)
 https://neo4j.com/docs/operations-manual/current/monitoring/

 
 
 
